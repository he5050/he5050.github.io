(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{328:function(e,a,t){"use strict";t.r(a),function(e){t.d(a,"default",(function(){return d}));var n,c=t(107),o=(t(305),t(0),t(108)),s=["components"];function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function r(e,a){if(null==e)return{};var t,n,c=function(e,a){if(null==e)return{};var t,n,c={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(c[t]=e[t]);return c}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(c[t]=e[t])}return c}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,m,N=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(o.b)("div",a)}},u=N("Footer"),l={};function d(e){var a=e.components,t=r(e,s);return Object(o.b)("wrapper",p({},l,t,{components:a,mdxType:"MDXLayout"}),Object(o.b)("blockquote",null,Object(o.b)(u,{mdxType:"Footer"})),Object(o.b)("h1",{className:"__internal",id:"11不得不说的闭包"},"11.不得不说的闭包",Object(o.b)("a",{parentName:"h1",href:"#11%E4%B8%8D%E5%BE%97%E4%B8%8D%E8%AF%B4%E7%9A%84%E9%97%AD%E5%8C%85","aria-hidden":!0,className:"anchor"},"#")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"啥也不说先从下面这个例子看起")),Object(o.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(o.b)("pre",{parentName:"div",className:"language-js"},Object(o.b)("code",{parentName:"pre",className:"language-js"},Object(o.b)("span",{parentName:"code",className:"token keyword"},"let")," bb ",Object(o.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token parameter"},"a"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token parameter"},"b"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"return")," a ",Object(o.b)("span",{parentName:"code",className:"token operator"},"+")," b",Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token parameter"},"a",Object(o.b)("span",{parentName:"span",className:"token punctuation"},",")," b"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"return")," a ",Object(o.b)("span",{parentName:"code",className:"token operator"},"*")," b",Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token number"},"1"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(o.b)("span",{parentName:"code",className:"token number"},"2"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n",Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(o.b)("span",{parentName:"code",className:"token function"},"bb"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token number"},"3"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))),Object(o.b)("p",null,"我们先跳过上面，请看下面的代码，并在 Chrome 控制台中调试运行一下，我们可以看到如下\n",Object(o.b)("img",{parentName:"p",src:"/images/closure.png",alt:"/closure"})),Object(o.b)("div",{className:"rcpress-highlight","data-language":"js"},Object(o.b)("pre",{parentName:"div",className:"language-js"},Object(o.b)("code",{parentName:"pre",className:"language-js"},"\n",Object(o.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(o.b)("span",{parentName:"code",className:"token function"},"createClosure"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"const")," foo ",Object(o.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(o.b)("span",{parentName:"code",className:"token string"},'"我是闭包"'),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"debugger"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n      console",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(o.b)("span",{parentName:"code",className:"token function"},"log"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),"foo",Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n      ",Object(o.b)("span",{parentName:"code",className:"token keyword"},"return")," foo",Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(o.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(o.b)("span",{parentName:"code",className:"token keyword"},"let")," c ",Object(o.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(o.b)("span",{parentName:"code",className:"token function"},"createClosure"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(o.b)("span",{parentName:"code",className:"token keyword"},"debugger"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(o.b)("span",{parentName:"code",className:"token function"},"c"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(o.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(o.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))),Object(o.b)("p",null,"闭包是在返回一个引用了外部作用域变量的函数的时候，为了把环境保存下来，创建的一个快照，并且对作用域链做了",Object(o.b)("inlineCode",{parentName:"p"},"tree shaking"),"，只留下必要的闭包链，保存在堆里，作为对象的 [","[scopes]","] 属性。因为此时还没执行函数，所以要静态分析标识符引用，确定用到了那些变量，打包保存下来。"))}d.isMDXComponent=!0,d=Object(c.hot)(e)(d),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(N,"makeShortcode","E:\\h-project\\my-blog\\docs\\notes\\2021-07-04.md"),b.register(u,"Footer","E:\\h-project\\my-blog\\docs\\notes\\2021-07-04.md"),b.register(l,"layoutProps","E:\\h-project\\my-blog\\docs\\notes\\2021-07-04.md"),b.register("wrapper","MDXLayout","E:\\h-project\\my-blog\\docs\\notes\\2021-07-04.md"),b.register(d,"MDXContent","E:\\h-project\\my-blog\\docs\\notes\\2021-07-04.md")),(m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&m(e)}.call(this,t(4)(e))}}]);