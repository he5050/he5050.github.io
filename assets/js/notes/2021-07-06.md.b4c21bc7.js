(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{358:function(e,a,n){"use strict";n.r(a),function(e){n.d(a,"default",(function(){return O}));var t,c=n(123),s=(n(333),n(0),n(124)),o=["components"];function p(){return(p=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function m(e,a){if(null==e)return{};var n,t,c=function(e,a){if(null==e)return{};var n,t,c={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(c[n]=e[n]);return c}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var b,N,r=function(e){return function(a){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",a)}},u=r("Footer"),l=r("FunButtonOne"),j=r("UndoDemo"),k={};function O(e){var a=e.components,n=m(e,o);return Object(s.b)("wrapper",p({},k,n,{components:a,mdxType:"MDXLayout"}),Object(s.b)("blockquote",null,Object(s.b)(u,{mdxType:"Footer"})),Object(s.b)("h1",{className:"__internal",id:"13hooks"},"13.hooks",Object(s.b)("a",{parentName:"h1",href:"#13hooks","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"我们在前面说过,hooks当中存在一个问题，就是hooks的捕获特性,还记得这个示例嘛")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"FunButtonOne")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setNum",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"handleClick")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"setTimeout"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            console",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 0"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"3000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"setNum"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"num ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"handleClick",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"函数式组件("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token plain-text"},")"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))),Object(s.b)(l,{mdxType:"FunButtonOne"}),Object(s.b)("p",null,"通过setNum，set一个新值后，原来的值会形成一个新的引用在下次渲染时。但由于对 state 的读取没有通过 this. 的方式，",Object(s.b)("strong",{parentName:"p"},Object(s.b)("em",{parentName:"strong"},"使得每次 setTimeout 都读取了当时渲染闭包环境的数据，虽然最新的值跟着最新的渲染变了，但旧的渲染里，状态依然是旧值。"))),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},Object(s.b)("em",{parentName:"strong"},"每一个渲染都是一个独立的闭包，在独立的渲染中，count 在每次渲染中的值是 0 ，所以无论 setTimeout 延时多久，打印出来的结果永远是 0。"))),Object(s.b)("h3",{className:"__internal",id:"usestate"},"useState",Object(s.b)("a",{parentName:"h3",href:"#usestate","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"10"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")))),Object(s.b)("p",null,"为什么 useState 要使用数组而不是对象?"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token comment"},"// 数组"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," foo ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"2"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"3"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"one",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," two",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," three",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," foo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\nconsole",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"one",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\t",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 1"),"\nconsole",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"two",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\t",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 2"),"\nconsole",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"three",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\t",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 3"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 对象"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," user ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  id",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"888"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n  name",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"xiaoxin"'),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," name ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," user",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\nconsole",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\t",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 888"),"\nconsole",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"name",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\t",Object(s.b)("span",{parentName:"code",className:"token comment"},'// "xiaoxin"'),"\n"))),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul",className:"__internal"},"如果 useState 返回的是数组，那么使用者可以对数组中的元素命名，代码看起来也比较干净"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"如果 useState 返回的是对象，在解构对象的时候必须要和 useState 内部实现返回的对象同名，想要使用多次的话，必须得设置别名才能使用返回值"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"最最重要的其实就是为了降低复杂度")),Object(s.b)("p",null,"useState 目前的是将变量名打平，而非像 Class Component 一样写在一个 State 对象里"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul",className:"__internal"},Object(s.b)("inlineCode",{parentName:"li"},"setState")," 更新state是",Object(s.b)("strong",{parentName:"li"},"异步"),"更新策略，参数有两种，一种要更新的",Object(s.b)("strong",{parentName:"li"},"值"),"，第二种是一个更新的",Object(s.b)("strong",{parentName:"li"},"函数"),"，返回要更新的值。"),Object(s.b)("li",{parentName:"ul",className:"__internal"},Object(s.b)("inlineCode",{parentName:"li"},"setState"),"不会进行",Object(s.b)("strong",{parentName:"li"},"合并更新"),"，只会",Object(s.b)("strong",{parentName:"li"},"全量更新"),"，所以参数或回调函数值应该要更新的值。")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 函数组件"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," FunctionComponent ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"left",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"setLeft",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"top",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"setTop",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"width",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"setWidth",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"height",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"setHeight",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 类组件"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"class")," ",Object(s.b)("span",{parentName:"code",className:"token class-name"},"ClassComponent")," ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"extends")," ",Object(s.b)("span",{parentName:"code",className:"token class-name"},"React",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"."),"PureComponent")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  state ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    left",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    top",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    width",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    height",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("p",null,"如果有很多的状态类管理的话，那我们不可能写很多useState,我可以通过useState传方法的的形式来处理"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"FunctionComponent"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    left",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    top",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    width",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    height",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 使用useState(()=>{})来处理"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token function"},"setState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"state")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," left",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," top",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 如果 initialState 是为复杂数据时"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," initialState ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"otherFun"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," initialState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},Object(s.b)("em",{parentName:"strong"},"如何避掉捕获特性?"))),Object(s.b)("h3",{className:"__internal",id:"useref"},"useRef",Object(s.b)("a",{parentName:"h3",href:"#useref","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"FunButtonOne")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," num ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useRef"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"handleClick")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"current",Object(s.b)("span",{parentName:"code",className:"token operator"},"++"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"setTimeout"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            console",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"current",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 1"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"3000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"handleClick",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"函数式组件("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token plain-text"},")"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")))),Object(s.b)("p",null,"useRef 返回一个可变的 ref 对象，其 current 属性被初始化为传入的参数。返回的 ref 对象在组件的整个重新渲染过程持续存在。与useState的区别在于 useState创建的对象，在每个重新渲染过程内都是独立的而ueseRef是",Object(s.b)("strong",{parentName:"p"},"共享的")),Object(s.b)("p",null,Object(s.b)("strong",{parentName:"p"},Object(s.b)("em",{parentName:"strong"},"useRef当中的值发生了变化但是不会触发组件的渲染"))),Object(s.b)("p",null,"如何解决上面的组件不会渲染的问题?"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"FunButtonOne")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setNum",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," count ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useRef"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token operator"},"=>"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"current ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"handleClick")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"setTimeout"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            console",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"current",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 1"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"3000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"setNum"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"num ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"handleClick",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"函数式组件("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"num",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token plain-text"},")"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")))),Object(s.b)("h3",{className:"__internal",id:"useeffect与uselayouteffect"},"useEffect与useLayoutEffect",Object(s.b)("a",{parentName:"h3",href:"#useeffect%E4%B8%8Euselayouteffect","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul",className:"__internal"},"相当于 componentDidMount 和 componentDidUpdate"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"useEffect中return一个函数的时候，相当于componentWillUnMount"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"页面初次渲染完成时，和state改变页面重新渲染后（dom更新完成时）执行"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"存在多个时，每个useEffect都会触发,useEffect的执行顺序与它代码书写的顺序是一致的")),Object(s.b)("p",null,"我们来看下面的例子"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Counter"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," id ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"setInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",Object(s.b)("span",{parentName:"code",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"count ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"clearInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// count ：1"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("p",null,"useEffect的依赖项为空数组，在整个渲染周期只会运行一次传入的函数，所以setInterval一直处于count = 0这个闭包里，结果就会造成count的值在每次set后都是1"),Object(s.b)("p",null,"我们把依赖上加上去就可以正常了"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Counter"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," id ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"setInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",Object(s.b)("span",{parentName:"code",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"count ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"clearInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// count ：1 2 3 4 ..."),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("p",null,"上面通过依赖是解决了,每次计数器都会重新实例化并销毁，性能成本会增加，那有没有别方法来处理"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Counter"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," id ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"setInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",Object(s.b)("span",{parentName:"code",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"c")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," c ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"clearInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// count ：1 2 3 4 ..."),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("p",null,"但是如果count为对象数据的时候怎么处理呢"),Object(s.b)("p",null,"我们来看下面的下例子"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token comment"},"// 父组件"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"App"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," dep ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," name",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"我是app"')," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n      "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Child"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"dep"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"dep",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}"))," ",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"/>")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n      "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"div")," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"span",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"span",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),"count ",Object(s.b)("span",{parentName:"span",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"span",className:"token number"},"1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"Count "),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n    "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 子组件"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"Child")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token parameter"},"props")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    console",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token string"},'"dep"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"Child"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))),Object(s.b)("p",null,"这里你会发现你在App组件当中的每一个onclik,子组件都是打印出dep,当我们的依赖是一个引用对像而非具体的值时\n子组件每次接到的都一个新值,所以发生重复渲染\n如何解决呢:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    console",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"log"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token string"},'"dep"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token constant"},"JSON"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"stringify"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 或者在父亲组件当中"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," dep ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useRef"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," name",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"我是app"')," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")))),Object(s.b)("p",null,"useLayoutEffect的使用一样，不过有几下几点不同"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul",className:"__internal"},"当需要处理dom时，使用",Object(s.b)("inlineCode",{parentName:"li"},"useEffect"),"会导致闪屏问题"),Object(s.b)("li",{parentName:"ul",className:"__internal"},Object(s.b)("inlineCode",{parentName:"li"},"useLayoutEffect"),"会在DOM更新完成后",Object(s.b)("strong",{parentName:"li"},"立即执行"),"，在浏览器进行回执之前运行"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"会阻塞浏览器的绘制")),Object(s.b)("h3",{className:"__internal",id:"usecontext"},"useContext",Object(s.b)("a",{parentName:"h3",href:"#usecontext","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("p",null,"可以解决多层组件传值的情况，类似vue的privde/inject\n如何使用:"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token comment"},"// 爸爸的爸爸叫"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," themes ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  light",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    color",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"#000"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n  dark",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    color",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"#fff"'),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ThemeContext ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," React",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"createContext"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"themes",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"light",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"  ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// createContext创建，      参数为默认值，可选"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"GrandFather"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"ThemeContext.Provider"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"value"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"themes",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"."),"dark",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"}," //通过value绑定要传入的值\n      "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Father"))," ",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"/>")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n    "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"ThemeContext.Provider")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 这也是爸爸"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Father"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n      "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Son"))," ",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"/>")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n    "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 这就是孙子"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Son"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," theme ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useContext"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"ThemeContext",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"//使用useContext接收传来的值"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"button")," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"style"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{")," color",Object(s.b)("span",{parentName:"span",className:"token operator"},":")," theme",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"."),"color ",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n      这就是孙子\n    "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"button"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n"))),Object(s.b)("h3",{className:"__internal",id:"usereducer"},"useReducer",Object(s.b)("a",{parentName:"h3",href:"#usereducer","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"Counter"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 第一位是 reducer，第二位是初始值 initialState。reducer 定义了如何对数据进行变换，"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," initialState ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    count",Object(s.b)("span",{parentName:"code",className:"token operator"},":"),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    step",Object(s.b)("span",{parentName:"code",className:"token operator"},":"),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," dispatch",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useReducer"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"reducer",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," initialState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," step ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," id ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"setInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n      ",Object(s.b)("span",{parentName:"code",className:"token function"},"dispatch"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," type",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"interval"')," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1000"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"clearInterval"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"id",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"dispatch",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"count",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"reducer"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"state",Object(s.b)("span",{parentName:"span",className:"token punctuation"},",")," action"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"switch")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"action",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"type",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"case")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"interval"'),Object(s.b)("span",{parentName:"code",className:"token operator"},":"),"\n      ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n        count",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"count ",Object(s.b)("span",{parentName:"code",className:"token operator"},"+")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"step\n      ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("h3",{className:"__internal",id:"usememo与usecallback"},"useMemo与useCallback",Object(s.b)("a",{parentName:"h3",href:"#usememo%E4%B8%8Eusecallback","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("p",null,"两者的用法基本一样"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},"\n",Object(s.b)("span",{parentName:"code",className:"token function"},"useMemo"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token operator"},"=>"),"cb",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 返回结果"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"cb",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"dep",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 返回函数"),"\n"))),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul",className:"__internal"},"缓存函数，避免重复渲染,可以用于性能优化"),Object(s.b)("li",{parentName:"ul",className:"__internal"},"两个使用方法差不多",Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",{parentName:"ul",className:"__internal"},Object(s.b)("strong",{parentName:"li"},"useCallback创建时（渲染页面）不去执行里面的函数")),Object(s.b)("li",{parentName:"ul",className:"__internal"},Object(s.b)("strong",{parentName:"li"},"useMemo创建时（渲染页面）会执行一次"))))),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token operator"},"=>"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"code",className:"token function"},"doSomething"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"deps",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," deps",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"//相当于"),"\n",Object(s.b)("span",{parentName:"code",className:"token function"},"useMemo"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 返回一个函数"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token operator"},"=>"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"doSomething"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"deps",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," deps",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"。"))),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"Child")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token parameter"},"props")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  \t",Object(s.b)("span",{parentName:"code",className:"token comment"},"// ..."),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"name",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useMemo"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n    ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"name",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"h1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"props",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"name",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("h3",{className:"__internal",id:"自定义hooks"},"自定义hooks",Object(s.b)("a",{parentName:"h3",href:"#%E8%87%AA%E5%AE%9A%E4%B9%89hooks","aria-hidden":!0,className:"anchor"},"#")),Object(s.b)("p",null,"自定义hooks的简单示例"),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"function")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useScrollPosition"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"scrollPosition",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," setScrollPosition",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useState"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token keyword"},"null"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token function"},"useEffect"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"handleScroll")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"setScrollPosition"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"window",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"scrollY",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    document",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"addEventListener"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token string"},'"scroll"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," handleScroll",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>"),"\n      document",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"removeEventListener"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token string"},'"scroll"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," handleScroll",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n  ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n  ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," scrollPosition",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n"))),Object(s.b)("p",null,"这是基于useCallback与useReducer实现的一个自定义hooks的实例\n主要对两个数组用于存取操作的顺序"),Object(s.b)(j,{mdxType:"UndoDemo"}),Object(s.b)("div",{className:"rcpress-highlight","data-language":"jsx"},Object(s.b)("pre",{parentName:"div",className:"language-jsx"},Object(s.b)("code",{parentName:"pre",className:"language-jsx"},Object(s.b)("span",{parentName:"code",className:"token keyword"},"import")," React",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," useReducer",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," useCallback ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"from")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"react"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"import")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," Button ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"from")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"antd"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," initialState ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    undoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 撤销操作对列"),"\n    activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"null"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 当前操作"),"\n    redoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 重置操作对列"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 定义我们的actions类型"),"\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ActionType ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    Undo",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"UNDO"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 撤销"),"\n    Redo",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"REDO"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 重做"),"\n    Set",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"SET"'),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n    Reset",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token string"},'"RESET"'),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"reducer")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"state",Object(s.b)("span",{parentName:"span",className:"token punctuation"},",")," action"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," activeNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," redoList ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"switch")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"action",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"type",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"case")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Undo",Object(s.b)("span",{parentName:"code",className:"token operator"},":"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 撤销"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"if")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"===")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," previous ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"-")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," newUndoList ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"slice"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"-")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                undoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," newUndoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," previous",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                redoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"activeNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"redoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"case")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Redo",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 重做"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"if")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"redoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"===")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," next ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," redoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," newRedoList ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," redoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),Object(s.b)("span",{parentName:"code",className:"token function"},"slice"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"1"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                undoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," activeNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," next",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                redoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," newRedoList\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"case")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Set",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 新值"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," newActiveNow ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," action",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"if")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"newActiveNow ",Object(s.b)("span",{parentName:"code",className:"token operator"},"===")," activeNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                undoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," activeNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," newActiveNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                redoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"case")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Reset",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 重置"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," newActiveNow ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," action",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n            ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                undoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," newActiveNow",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n                redoList",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"useUndo")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token parameter"},"initial")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," dispatch",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useReducer"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"reducer",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token operator"},"..."),"initialState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},","),"\n        activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," initial\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," canUndo ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"undoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"!==")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 是否可以操作撤销"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," canRedo ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"redoList",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"length ",Object(s.b)("span",{parentName:"code",className:"token operator"},"!==")," ",Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 是否可以重做"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," undo ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"if")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"canUndo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token function"},"dispatch"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," type",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Undo ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"canUndo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," redo ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"if")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"canRedo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",Object(s.b)("span",{parentName:"code",className:"token function"},"dispatch"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," type",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Redo ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n        ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"canRedo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," set ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"newActiveNow")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"dispatch"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," type",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Set",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," newActiveNow ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," reset ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"useCallback"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token parameter"},"newActiveNow")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token function"},"dispatch"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," type",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," ActionType",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"."),"Reset",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," newActiveNow ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"state",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," set",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," reset",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," undo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," redo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," canUndo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," canRedo ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";")," ",Object(s.b)("span",{parentName:"code",className:"token comment"},"// 这里也可以改成数组返回 那样的话需要注意接收参数的顺序"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n",Object(s.b)("span",{parentName:"code",className:"token keyword"},"export")," ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token function-variable function"},"UndoDemo")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"["),"countState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," set",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," setCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," reset",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," resetCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," undo",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," undoCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," redo",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," redoCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," canUndo",Object(s.b)("span",{parentName:"code",className:"token punctuation"},",")," canRedo ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"]")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"="),"\n        ",Object(s.b)("span",{parentName:"code",className:"token function"},"useUndo"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"code",className:"token number"},"0"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"const")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{")," activeNow",Object(s.b)("span",{parentName:"code",className:"token operator"},":")," activeNowCount ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}")," ",Object(s.b)("span",{parentName:"code",className:"token operator"},"=")," countState",Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n\n    ",Object(s.b)("span",{parentName:"code",className:"token keyword"},"return")," ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),"p"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"点击次数: "),Object(s.b)("span",{parentName:"code",className:"token punctuation"},"{"),"activeNowCount",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"p"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"key"),Object(s.b)("span",{parentName:"span",className:"token attr-value"},Object(s.b)("span",{parentName:"span",className:"token punctuation attr-equals"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'),"increment",Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"span",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"span",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),"activeNowCount ",Object(s.b)("span",{parentName:"span",className:"token operator"},"+")," ",Object(s.b)("span",{parentName:"span",className:"token number"},"1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n                +\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"key"),Object(s.b)("span",{parentName:"span",className:"token attr-value"},Object(s.b)("span",{parentName:"span",className:"token punctuation attr-equals"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'),"decrement",Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"span",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"span",className:"token function"},"setCount"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),"activeNowCount ",Object(s.b)("span",{parentName:"span",className:"token operator"},"-")," ",Object(s.b)("span",{parentName:"span",className:"token number"},"1"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n                -\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"key"),Object(s.b)("span",{parentName:"span",className:"token attr-value"},Object(s.b)("span",{parentName:"span",className:"token punctuation attr-equals"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'),"undo",Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"undoCount",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"disabled"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token operator"},"!"),"canUndo",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n                撤销\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"key"),Object(s.b)("span",{parentName:"span",className:"token attr-value"},Object(s.b)("span",{parentName:"span",className:"token punctuation attr-equals"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'),"redo",Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),"redoCount",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"disabled"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token operator"},"!"),"canRedo",Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n                重做\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"<"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button"))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"key"),Object(s.b)("span",{parentName:"span",className:"token attr-value"},Object(s.b)("span",{parentName:"span",className:"token punctuation attr-equals"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'),"reset",Object(s.b)("span",{parentName:"span",className:"token punctuation"},'"'))," ",Object(s.b)("span",{parentName:"span",className:"token attr-name"},"onClick"),Object(s.b)("span",{parentName:"span",className:"token script language-javascript"},Object(s.b)("span",{parentName:"span",className:"token script-punctuation punctuation"},"="),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"{"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")")," ",Object(s.b)("span",{parentName:"span",className:"token operator"},"=>")," ",Object(s.b)("span",{parentName:"span",className:"token function"},"resetCount"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"("),Object(s.b)("span",{parentName:"span",className:"token number"},"0"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},"}")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n                重置\n            "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),Object(s.b)("span",{parentName:"span",className:"token class-name"},"Button")),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),Object(s.b)("span",{parentName:"code",className:"token plain-text"},"\n        "),Object(s.b)("span",{parentName:"code",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token tag"},Object(s.b)("span",{parentName:"span",className:"token punctuation"},"</"),"div"),Object(s.b)("span",{parentName:"span",className:"token punctuation"},">")),"\n    ",Object(s.b)("span",{parentName:"code",className:"token punctuation"},")"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n",Object(s.b)("span",{parentName:"code",className:"token punctuation"},"}"),Object(s.b)("span",{parentName:"code",className:"token punctuation"},";"),"\n"))))}O.isMDXComponent=!0,O=Object(c.hot)(e)(O),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(r,"makeShortcode","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register(u,"Footer","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register(l,"FunButtonOne","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register(j,"UndoDemo","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register(k,"layoutProps","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register("wrapper","MDXLayout","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md"),b.register(O,"MDXContent","E:\\h-project\\my-blog\\docs\\notes\\2021-07-06.md")),(N="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&N(e)}.call(this,n(3)(e))}}]);