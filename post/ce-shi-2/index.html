<html>

<head>
  <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<title>关于使用puppeteer的screenshot截图乱码 | 庵主老衲来也</title>
<link rel="shortcut icon" href="https://he5050.github.io/favicon.ico?v=1562727950138">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
  integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<link rel="stylesheet" href="https://he5050.github.io/styles/main.css" type='text/css' media='all'>

<script src="https://he5050.github.io/media/scripts/lib/scrollreveal.min.js"></script>

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">



  <style>
    .loop-container {
      position: relative;
    }

    .toc-title {
      position: absolute;
      top: 0;
      right: 0;
      transition: all .5s;
      width: 40px;
      background-color: #ee4d4d;
      color: #fff;
      height: 20px;
      line-height: 20px;
      font-size: 14px;
      text-align: center;
      border-radius: 5px;
      cursor: pointer;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .hide {
      right: -40px;
    }

    .toc-card {
      position: absolute;
      top: 0;
      right: -200px;
      transition: all .5s;
      width: 200px;
      background-color: #ee4d4d;
      color: #fff;
    }

    .toc-card ul li a {
      color: #fff;
      transition: all .5s;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .toc-card ul li a:hover {
      font-size: 20px;
      text-decoration: underline;
      text-decoration-color: #000;
      text-decoration-style: wavy;

    }

    .active {
      right: 0px;
    }
  </style>
</head>

<body class="home blog ct-body standard">
  <canvas id="canvas" class="canvas"></canvas>
  <div id="overflow-container" class="overflow-container">
    <header id="site-header" class="site-header" role="banner">


    <div class="container">
        <div id="title-info" class="title-info">
            <div id='site-title' class='site-title'>
                <a href="https://he5050.github.io"> 庵主老衲来也 </a>
            </div>
        </div>
        <button id="toggle-navigation" class="toggle-navigation">
            <i class="fa fa-bars"></i>
        </button>
        <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
        <div id="menu-primary" class="menu-container menu-primary" role="navigation">
            <p class="site-description">五年前端三年切图@怡红院
</p>
            <div class="menu">
                <ul id="menu-primary-items" class="menu-primary-items">
                    
                    
                    <li id="menu-item"
                        class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                        <a href="/">首页</a>
                    </li>
                    
                    
                    
                    <li id="menu-item"
                        class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                        <a href="/archives">归档</a>
                    </li>
                    
                    
                    
                    <li id="menu-item"
                        class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                        <a href="/tags">标签</a>
                    </li>
                    
                    
                    
                    <li id="menu-item"
                        class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                        <a href="http://www.leeling.top/" target="_blank">自用播放器</a>
                    </li>
                    
                    
                </ul>
            </div>
        </div>
    </div>


</header>


    <div id="main" class="main" role="main">
      <div class="clock-warp" id="clock-custom">
  <div class="time-warp">
    <div class="city-warp"><span class="title">日期:</span> &nbsp; &nbsp;<span class="day-content">2019年7月2日
        (星期二)</span></div>
    <div class="time-warp"><span class="title">农历:</span> &nbsp; &nbsp;<span class="lunar-content">五月十五
        (己亥年庚午月庚子日)</span></div>
    <div class="tips-warp"><span class="title">提醒:</span> &nbsp; &nbsp;<span
        class="tips-content">各项气象条件适宜，发生感冒机率较低。但请避免长期处于空调房间中，以防感冒。</span></div>
  </div>
  <div class="clock-box">
    <div class="fill">
      <div class="reference"></div>
      <div class="clock" id="utility-clock">
        <div class="centre">
          <div class="dynamic"></div>
          <div class="expand round circle-1"></div>
          <div class="anchor hour">
            <div class="element thin-hand"></div>
            <div class="element fat-hand"></div>
          </div>
          <div class="anchor minute">
            <div class="element thin-hand"></div>
            <div class="element fat-hand minute-hand"></div>
          </div>
          <div class="anchor second">
            <div class="element second-hand"></div>
          </div>
          <div class="expand round circle-2"></div>
          <div class="expand round circle-3"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="weather-warp">
  <div id="weather-view-he"></div>
</div>

      <div id="loop-container" class="loop-container">
        <div
          class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">
          
          <div class='featured-image lazy lazy-bg-image max-bg' data-background="http://ww1.sinaimg.cn/large/69abf49bly1g4lcjokqzhj21hc0u0gvh.jpg">
          </div>
          

          <div class="entry-meta">
            <span class="date">· 2019年 02/07 Tue ·</span>

            
            <span class="category">
              <span> / </span>
              <a href="https://he5050.github.io/tag/PbtT_RHgp">puppeteer</a>
            </span>
            
            <span class="category">
              <span> / </span>
              <a href="https://he5050.github.io/tag/ie2_l5xTf">乱码</a>
            </span>
            
          </div>
          <div class='entry-header'>
            <h1 class='entry-title'>关于使用puppeteer的screenshot截图乱码</h1>
          </div>
          <div class="entry-container">
            <div class="entry-content">
              <article>
                <p>前一会得空写了一个微信小助手，发现在centos上面发微信发送图片为乱码</p>
<!-- more -->
<h1 id="screenshot截图乱码">screenshot截图乱码</h1>
<p>如图所示：
<img src="http://ww1.sinaimg.cn/large/69abf49bly1g4ujzb8b9gj20bi0kg79e.jpg" alt=""></p>
<h2 id="问题">问题</h2>
<p>后面在网上查了一下原来是因为字体库的问题</p>
<h2 id="解决">解决</h2>
<h3 id="1-安装fontconfig">1. 安装fontconfig</h3>
<ul>
<li><code>yum -y install fontconfig</code></li>
<li>在执行完上述命令后，就可以在<code>/usr/share</code>文件里面的<code>fonts</code>和<code>fontconfig</code></li>
</ul>
<h3 id="2-添加中文字体库">2. 添加中文字体库</h3>
<ul>
<li>在CentOS的/usr/share/fonts新建一个叫chinese的文件夹<code>mkdir /usr/share/fonts/chinese</code></li>
<li>从<code>window</code>的<code>C:\Windows\Fonts</code>里面把你需要的字体拷贝出来。比如说我需要宋体，我就选择<code>simsun.ttc</code>上传到<code>/usr/share/fonts/chinese</code></li>
<li>修改chinese目录的权限。<code>chmod -R 775 /usr/share/fonts/chinese</code></li>
<li>接下来需要安装ttmkfdir来搜索目录中所有的字体信息，并汇总生成fonts.scale文件，输入命令<code>yum -y install ttmkfdir</code></li>
<li>执行ttmkfdir命令，<code>ttmkfdir -e /usr/share/X11/fonts/encodings/encodings.dir</code></li>
<li>修改字体配置文件，<code>vi /etc/fonts/fonts.conf</code></li>
</ul>
<p><img src="http://ww1.sinaimg.cn/large/69abf49bly1g4uk88063gj20gx06eglj.jpg" alt=""></p>
<ul>
<li>刷新内存中的字体缓存，<code>fc-cache</code></li>
<li>看一下现在机器上已经有了刚才添加的字体。<code>fc-list :lang=zh</code>,<code>fc-list</code></li>
</ul>

              </article>
              
              
<div class="toc-card i-card ">
  <div class="toc-title i-card-title">目录</div>
  <div class="toc-content">
    <ul class="markdownIt-TOC">
<li><a href="#screenshot%E6%88%AA%E5%9B%BE%E4%B9%B1%E7%A0%81">screenshot截图乱码</a>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98">问题</a></li>
<li><a href="#%E8%A7%A3%E5%86%B3">解决</a>
<ul>
<li><a href="#1-%E5%AE%89%E8%A3%85fontconfig">1. 安装fontconfig</a></li>
<li><a href="#2-%E6%B7%BB%E5%8A%A0%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93%E5%BA%93">2. 添加中文字体库</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
</div>


              
              <div class="toc-title">目录</div>
            </div>
          </div>
          
          <nav class="navigation pagination" role="navigation">
            <h2 class="screen-reader-text">Posts navigation</h2>
            <div class="nav-links">
              <a class="next page-numbers" style="font-size:20px"
                href="https://he5050.github.io/post/ce-shi">下一篇->常用库与资源站点收藏</a>
            </div>
          </nav>
          
        </div>
        <section id="comments" class="comments">
          
        </section>
      </div>
    </div>
    <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1 class="site-header">
        <a href="https://he5050.github.io"> 庵主老衲来也 </a>
    </h1>
    <p class="site-description" style="font-size:18px">五年前端三年切图@怡红院
</p>
    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">
            <ul id="menu-footer-items" class="menu-footer-items">
            </ul>
        </div>
    </div>
    <ul class="social-media-icons">
        
        
        <li>
            <a href="https://github.com/he5050" data-animate-hover="pulse" class="github" target="_blank">
                <i class="fab fa-github"
                    title="github"></i>
                <span class="screen-reader-text">github</span>
            </a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </ul>
    <div class="design-credit">
        <p><span class="footer-tips">天赋决定了你能达到的上限，努力程度决定了你能达到的下限。以绝大多数人的努力程度之低，远远没有达到要去拼天赋的地步。</span></p>
    </div>
</footer>
<script>
    WIDGET = { ID: 'uN0i1Pg6Tc' };
    hljs.initHighlightingOnLoad()
    window._info = {

        timer: new Date().getTime(),

    };
</script>
<script src="https://pv.sohu.com/cityjson?ie=utf-8"></script>
<script type="text/javascript" src="https://apip.weatherdt.com/view/static/js/r.js?v=1111"></script>
<script src="https://he5050.github.io/media/scripts/lib/jquery.min.js"></script>
<script src="https://he5050.github.io/media/scripts/lib/jquerymigrate.js"></script>
<script src="https://he5050.github.io/media/scripts/lib/production.min.js"></script>
<script src="https://he5050.github.io/media/scripts/lib/calendar.js"></script>
<script src="https://he5050.github.io/media/scripts/lib/clock.js"></script>

  </div>
  <script>
    var toc = $(".toc-title");
    var mu = $(".toc-card");
    toc.click(function () {
      if (toc.hasClass("hide")) {
        toc.removeClass("hide");
      } else {
        toc.addClass("hide");
        mu.addClass("active");
      }
    });
    mu.mouseleave(function () {
      mu.removeClass("active");
      toc.removeClass("hide");
    });
    // /*获取文章目录集合,可通过:header过滤器*/
    // var alis = $('.post-content :header');
    // /*获取侧边栏目录列表集合**/
    // var sidebar_alis = $('.markdownIt-TOC a');

    // function locateCatelogList() {
    //   /*获取滚动条到顶部的距离*/
    //   var scroll_height = $(window).scrollTop();
    //   for (var i = 0; i < alis.length; i++) {
    //     /*获取锚点集合中的元素分别到顶点的距离*/
    //     var a_height = $(alis[i]).offset().top;
    //     if (a_height < scroll_height) {
    //       /*高亮显示*/
    //       console.log("asdfasdfa");
    //       sidebar_alis.removeClass('on');
    //       $(sidebar_alis[i]).addClass('on');
    //     }
    //   }
    // }
    var tocH = toc.offset().top;
    window.addEventListener(
      "scroll", function () {
        var scrollTop =
          window.pageYOffset ||
          document.documentElement.scrollTop ||
          document.body.scrollTop;
        //console.log("滚地偶那个scrollTop", scrollTop, tocH);
        var top = 0;
        if (scrollTop > tocH) {
          top = scrollTop - tocH + 50;

        }
        $(".toc-title").css("top", top);
      })
  </script>
</body>

</html>
